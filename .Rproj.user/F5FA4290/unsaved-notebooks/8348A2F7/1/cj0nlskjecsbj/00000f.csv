"0","renderPlotly({"
"0","by_cat_cur <- reactive_df() |>"
"0","dplyr::group_by(category) |>"
"0","dplyr::summarise("
"0","sales = sum(sales, na.rm=TRUE),"
"0","profit = sum(profit, na.rm=TRUE),"
"0",".groups = ""drop"""
"0",") |>"
"0","dplyr::mutate(avg_margin = dplyr::if_else(sales > 0, profit / sales, NA_real_))"
"0",""
"0",""
"0",""
"0",""
"0","p <- ggplot(by_cat_cur, aes(x = reorder(category, avg_margin), y = avg_margin)) +"
"0","geom_col() + coord_flip() +"
"0","scale_y_continuous(labels = scales::percent) +"
"0","labs(title = ""Average Profit Margin by Category"", x = NULL, y = ""Avg Margin"")"
"0",""
"0",""
"0",""
"0",""
"0","ggplotly(p)"
"0","})"
"1","<shiny.render.function> 
"
